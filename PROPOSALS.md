# 機能提案と使いやすさの向上 (Proposal)

本プロジェクト「Guesthouse Marusho」予約システムに対し、以下の改善点を提案します。

## 1. ユーザー体験 (UX) の向上

### レスポンシブデザインの強化 (Mobile Usability)
現在、管理画面のテーブル表示などはPC向けに最適化されていますが、スマートフォンやタブレットでの閲覧時にはレイアウトが崩れる可能性があります。
- **提案:**
    - CSSメディアクエリやBootstrap/Tailwind CSSを活用し、モバイル端末でも予約状況の確認や承認作業をスムーズに行えるようにする。
    - **カレンダーUIの改善:** FullCalendarのタイムラインビューはスマホの狭い画面では見づらいため、モバイルでは「リストビュー」または「縦型リソースビュー」に自動で切り替わる仕組みを導入する。
    - **タッチターゲットの最適化:** ボタンやリンクのサイズを拡大し、タッチ操作での誤操作を防ぐ。

### 多言語対応 (i18n)
ゲストハウスという性質上、海外からの旅行者も想定されます。
- **実装済み:** `lang/ja.json`, `lang/en.json` と `t()` 関数による多言語化基盤は構築済み。
- **今後の課題:** データベース内の静的コンテンツ（部屋説明など）以外の動的メッセージのエラーハンドリングや、メールテンプレートの多言語化をさらに洗練させる。

### 予約フローの改善 (AJAX化)
現在の予約フローはページ遷移を伴いますが、カレンダーから部屋を選択し、モーダルウィンドウで予約を完了できるようなSPA (Single Page Application) 的な挙動を取り入れることで、離脱率を低減できます。

## 2. 管理機能の強化 (Admin Efficiency)

### レポート・分析機能
売上の推移や稼働率を可視化する機能が不足しています。
- **提案:**
    - 月別・部屋タイプ別の売上グラフ
    - リピーター率の算出
    - キャンセル率の分析
    これらをダッシュボードに表示することで、経営判断に役立てることができます。

### 自動メール通知の拡充
予約確定時だけでなく、以下のタイミングでのメール送信を提案します。
- **リマインダーメール:** チェックイン3日前に自動送信（アクセス案内など）。
- **サンキューメール:** チェックアウト翌日に送信（レビュー依頼など）。

### 権限管理 (RBAC) の細分化
現在は「管理者」か「一般」かの2択ですが、スタッフの役割に応じた権限設定が必要です。
- **提案:**
    - 「予約閲覧のみ可能」な清掃スタッフ用アカウント
    - 「予約操作・顧客管理が可能」なフロントスタッフ用アカウント
    - 「全ての操作が可能」なマネージャー用アカウント

### 操作ログの記録 (Audit Logging)
現在、誰がいつ変更を行ったかの記録が残りません。
- **提案:** `admin_logs` テーブルを作成し、予約の作成・変更・削除、ユーザー情報の変更などの操作を記録する機能を実装する。これにより、不正操作や誤操作の追跡が可能になります。

## 3. セキュリティとインフラ

### バックアップの自動化
データベースの定期バックアップを自動化し、障害時の復旧体制を整える。

## 4. 使いやすさ・セキュリティの向上 (追加提案)

### A. セキュリティ強化 (ゲスト予約)
- **実装済み:** 予約時にランダムなトークンを生成し、推測不可能なURL (`confirm.php?token=...`) を発行することで、第三者による予約情報の閲覧を防止。
- **今後の課題:** トークンの有効期限設定や、一度閲覧したら無効化するワンタイムURL機能の検討。

### B. 管理画面のモバイル最適化
- スマートフォンからの管理も想定し、管理画面（`admin/`）のフォームやダッシュボードをモバイル対応にします。

### C. パスワード変更機能
- **実装済み:** 管理者によるユーザーパスワードのリセット機能を実装。
- **今後の課題:** ユーザー自身が「パスワードを忘れた場合」にメールでリセットできるセルフサービス機能の実装。

### D. 予約作成時の空室チェック (UX向上)
- **現状の課題:** 管理者用予約作成画面 (`add_booking.php`) で、送信ボタンを押すまでその部屋が空いているかわかりません。
- **提案:** 日付と部屋を選択した時点で、非同期通信 (AJAX) で空室状況をチェックし、既に予約がある場合はリアルタイムで警告を表示するように改善する。

### E. 予約導線の明確化
- **提案:** ログインユーザー（リピーター）とゲストユーザー（新規）の予約フローをより明確に分ける。トップページで「会員の方はこちら」「初めての方はこちら」と大きく誘導することで、会員登録のメリット（入力の手間削減）を訴求しやすくなる。
